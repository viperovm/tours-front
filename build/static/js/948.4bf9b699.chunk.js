"use strict";(self.webpackChunkyour_app=self.webpackChunkyour_app||[]).push([[948],{5615:function(e,t,c){c.r(t),c.d(t,{default:function(){return x}});var n=c(2791),s=c(5774),r=c(364),a=(c(7551),c(4850),c(7714)),i=c(885),o=(c(1354),c(4659),c(5087)),l=(c(8087),c(4772)),_=c(3924),u=c(4874),d=c(184),m=(0,r.$j)((function(e){return{}}),{})((function(e){var t=e.active_ticket,c=void 0!==t&&t,n=e.action;return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{className:s.Z.tickets_button,onClick:function(){n(!c)},children:c?"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443":"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"})})})),f={set_current_messages:_.Pm,clear_current_messages:_.ZL,set_all_messages_read:_.$S,set_all_messages_unread:_.E8,set_new_ticket:_.iK},h=(0,r.$j)((function(e){return{all_tickets:e.chat.all_tickets,archive_tickets:e.chat.archive_tickets,current_ticket:e.chat.current_ticket}}),f)((function(e){var t=e.current_ticket,c=e.set_current_messages,r=e.clear_current_messages,a=e.set_all_messages_read,_=e.set_all_messages_unread,f=e.set_new_ticket,h=(e.all_tickets,(0,n.useState)(!1)),v=(0,i.Z)(h,2),k=v[0],j=v[1],g=t?new o.w3cwebsocket("wss://traveler.market/ws/chat/".concat(t,"/?token=").concat(localStorage.getItem("access"))):null;(0,n.useEffect)((function(){return function(){r(),null===g||void 0===g||g.close()}})),(0,n.useEffect)((function(){g&&(g.onopen=function(){console.log("WebSocket Client Connected")},g.onclose=function(){console.log("WebSocket Client Disconnected")},g.onerror=function(e){console.error(e),console.log("Connection Error")},g.onmessage=function(e){var t=JSON.parse(e.data);t&&("set_read"===(null===t||void 0===t?void 0:t.command)?a():"set_unread"===(null===t||void 0===t?void 0:t.command)?_():c(t))})}),[g]);return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:s.Z.chat_messages,children:[3!==(null===t||void 0===t?void 0:t.status)&&(0,d.jsx)(m,{action:j,active_ticket:k}),(0,d.jsx)(u.Z,{}),(0,d.jsx)("div",{className:s.Z.send_button,children:k&&(0,d.jsx)(l.Z,{action:function(e){f({text:e})}})})]})})})),v=(c(2060),c(1212),c(5198)),k=(0,r.$j)((function(e){return{users_online:e.chat.users_online}}),{set_users_online:_.Ju})((function(e){var t=e.ticket,c=e.action,n=e.active,r=void 0!==n&&n,a=e.first,i=void 0!==a&&a,o=(e.users_online,e.set_users_online,t.id),l=t.last_message,_=(t.status,t.staff);return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{className:"".concat(s.Z.chat_contact_card," ").concat(r?s.Z.active:""," ").concat(i?s.Z.first:""),onClick:function(){c(o)},children:(0,d.jsx)("div",{className:s.Z.chat_contact_wrapper,children:(0,d.jsxs)("div",{className:s.Z.chat_contact_data,children:[(0,d.jsx)("div",{className:s.Z.chat_contact_name,children:"\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a #".concat(_)}),(0,d.jsx)("div",{className:s.Z.chat_contact_last_message,children:(0,v.aF)(l,20)})]})})})})})),j=(0,r.$j)((function(e){return{all_tickets:e.chat.all_tickets,current_ticket:e.chat.current_ticket}}),{set_current_room:_.OC,delete_chat_user:_.r9,clear_current_room:_.Uw,set_all_messages_unread:_.E8,set_current_ticket:_.E9})((function(e){var t=e.all_tickets,c=(e.chat_rooms,e.current_room,e.set_current_room,e.delete_chat_user,e.clear_current_room,e.set_all_messages_unread,e.set_current_ticket),n=e.current_ticket,r=function(e){c(e)};return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{className:s.Z.chat_contacts,children:null===t||void 0===t?void 0:t.map((function(e,t){return(0,d.jsx)(k,{ticket:e,action:r,active:n===e.id,first:0===t},t)}))})})})),g={get_all_tickets:_.B$},x=(0,r.$j)((function(e){return{}}),g)((function(e){var t=e.get_all_tickets;return(0,n.useEffect)((function(){window.scrollTo(0,0)}),[]),(0,n.useEffect)((function(){return t(),function(){}}),[]),(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(a.Z,{title:"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430",menu_item:"support",children:(0,d.jsxs)("div",{className:s.Z.chat_wrapper,children:[(0,d.jsx)(j,{}),(0,d.jsx)(h,{})]})})})}))}}]);
//# sourceMappingURL=948.4bf9b699.chunk.js.map